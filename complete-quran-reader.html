<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Holy Quran - Islamic Learning Companion</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .quran-reader {
            min-height: 100vh;
            background: linear-gradient(135deg, var(--dark-green), var(--medium-green));
            padding: 2rem 0;
        }
        
        .reader-header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .reader-title {
            font-size: 2.5rem;
            color: var(--gold);
            margin-bottom: 1rem;
            font-weight: 600;
        }
        
        .surah-navigation {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: rgba(255,255,255,0.1);
            color: var(--light-green);
            border: 2px solid var(--light-green);
            border-radius: 25px;
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 1rem;
        }
        
        .nav-btn:hover {
            background: var(--light-green);
            color: var(--dark-green);
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .surah-selector {
            background: var(--dark-green);
            color: var(--gold);
            border: 2px solid var(--gold);
            border-radius: 10px;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            min-width: 250px;
        }
        
        .surah-container {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem auto;
            max-width: 900px;
            border: 2px solid var(--gold);
        }
        
        .surah-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1.5rem;
            border-bottom: 2px solid var(--gold);
        }
        
        .surah-name-arabic {
            font-family: 'Amiri', serif;
            font-size: 2.5rem;
            color: var(--gold);
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .surah-name-english {
            font-size: 1.3rem;
            color: var(--light-green);
            margin-bottom: 0.5rem;
        }
        
        .surah-info {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .bismillah {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            text-align: center;
            border-left: 5px solid var(--gold);
        }
        
        .arabic-text {
            font-family: 'Amiri', serif;
            font-size: 1.8rem;
            color: var(--gold);
            margin-bottom: 0.5rem;
            line-height: 1.8;
            direction: rtl;
        }
        
        .transliteration {
            color: var(--light-green);
            font-style: italic;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }
        
        .translation {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 1rem;
        }
        
        .verse-block {
            background: rgba(255,255,255,0.03);
            border-radius: 15px;
            padding: 1.5rem;
            margin: 1rem 0;
            border-left: 4px solid var(--gold);
            transition: all 0.3s ease;
        }
        
        .verse-block:hover {
            background: rgba(255,255,255,0.08);
            transform: translateX(5px);
        }
        
        .verse-number {
            background: var(--gold);
            color: var(--dark-green);
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 1rem;
            font-size: 1rem;
        }
        
        .arabic-verse {
            font-family: 'Amiri', serif;
            font-size: 1.6rem;
            color: var(--gold);
            margin-bottom: 0.8rem;
            line-height: 2;
            text-align: right;
            direction: rtl;
        }
        
        .transliteration {
            color: var(--light-green);
            font-style: italic;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }
        
        .english-translation {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 1rem;
        }
        
        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--light-green);
        }
        
        .loading i {
            font-size: 2rem;
            margin-bottom: 1rem;
            animation: spin 2s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .back-to-home {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.1);
            color: var(--light-green);
            border: 2px solid var(--light-green);
            border-radius: 25px;
            padding: 0.5rem 1rem;
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .back-to-home:hover {
            background: var(--light-green);
            color: var(--dark-green);
        }
        
        .pagination {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            border-radius: 25px;
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            border: 2px solid var(--gold);
            z-index: 1000;
        }
        
        .page-btn {
            background: rgba(255,255,255,0.1);
            color: var(--light-green);
            border: 2px solid var(--light-green);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }
        
        .page-btn:hover {
            background: var(--light-green);
            color: var(--dark-green);
            transform: scale(1.1);
        }
        
        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .page-info {
            color: var(--gold);
            font-weight: 600;
            font-size: 1rem;
            min-width: 120px;
            text-align: center;
        }
        
        @media (max-width: 768px) {
            .reader-title {
                font-size: 2rem;
            }
            
            .surah-name-arabic {
                font-size: 2rem;
            }
            
            .arabic-text, .arabic-verse {
                font-size: 1.4rem;
            }
            
            .surah-navigation {
                flex-direction: column;
                align-items: stretch;
            }
            
            .surah-selector {
                min-width: auto;
                width: 100%;
            }
            
            .back-to-home {
                position: static;
                margin: 1rem;
                text-align: center;
                display: inline-block;
            }
            
            .pagination {
                bottom: 10px;
                padding: 0.4rem 0.8rem;
                gap: 0.8rem;
            }
            
            .page-btn {
                width: 45px;
                height: 45px;
                font-size: 1rem;
            }
            
            .page-info {
                font-size: 0.9rem;
                min-width: 100px;
            }
        }
    </style>
</head>
<body>
    <!-- Back to Home Button -->
    <a href="index.html" class="back-to-home">
        <i class="fas fa-home"></i> Back to Home
    </a>

    <!-- Quran Reader Section -->
    <section class="quran-reader">
        <div class="container">
            <!-- Reader Header -->
            <div class="reader-header">
                <h1 class="reader-title">
                    <i class="fas fa-book-quran"></i>
                    Complete Holy Quran
                </h1>
                <p style="color: var(--text-secondary); font-size: 1.1rem;">All 114 Surahs with Arabic text, transliteration, and translation</p>
            </div>
            
            <!-- Surah Navigation -->
            <div class="surah-navigation">
                <button class="nav-btn" id="prevSurah" onclick="previousSurah()" disabled>
                    <i class="fas fa-chevron-left"></i> Previous
                </button>
                <select id="surahSelect" class="surah-selector">
                    <option value="1">1. Al-Fatihah (The Opening)</option>
                    <!-- Options will be populated by JavaScript -->
                </select>
                <button class="nav-btn" id="nextSurah" onclick="nextSurah()">
                    Next <i class="fas fa-chevron-right"></i>
                </button>
                <button class="nav-btn" onclick="verifyCompleteQuran()" style="background: var(--success-green); color: white;">
                    <i class="fas fa-check-circle"></i> Verify Quran
                </button>
                <button class="nav-btn" onclick="testSurahDisplay(2)" style="background: var(--warning-orange); color: white;">
                    <i class="fas fa-search"></i> Test Surah 2
                </button>
                <button class="nav-btn" onclick="diagnoseVerseDisplay()" style="background: var(--error-red); color: white;">
                    <i class="fas fa-exclamation-triangle"></i> Diagnose Issue
                </button>
            </div>

            <!-- Quran Content -->
            <div class="quran-content" id="quranContent">
                <div class="loading">
                    <i class="fas fa-spinner"></i>
                    <h3>Loading the Complete Holy Quran...</h3>
                    <p>May Allah bless this effort for the Ummah</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Pagination -->
    <div class="pagination">
        <button class="page-btn" id="prevPageBtn" onclick="previousPage()">
            <i class="fas fa-chevron-left"></i>
        </button>
        <div class="page-info" id="pageInfo">
            Surah 1 of 114
        </div>
        <button class="page-btn" id="nextPageBtn" onclick="nextPage()">
            <i class="fas fa-chevron-right"></i>
        </button>
    </div>

    <!-- Scripts -->
    <script src="js/complete-quran-all-surahs.js"></script>
    <script src="js/quran-loader.js"></script>

    <!-- Sacred verification script -->
    <script>
        // Sacred verification guidance
        console.log('ü§≤ SACRED QURAN VERIFICATION SYSTEM ü§≤');
        console.log('=====================================');
        console.log('üìñ This system systematically verifies each surah');
        console.log('‚úÖ Checks Arabic text, transliteration, and translation');
        console.log('üîç Ensures all 114 surahs are complete and perfect');
        console.log('ü§≤ Sacred work done with utmost care and respect');
        console.log('=====================================');
        console.log('Use: verifyCompleteQuran() in console or click "Verify Quran" button');
        console.log('=====================================');
    </script>
    
    <script>
        let currentSurah = 1;
        let currentPage = 1;
        let surahData = {};
        let totalPages = 114; // Total number of surahs

        document.addEventListener('DOMContentLoaded', function() {
            // Wait for Quran data to load
            window.addEventListener('quranDataLoaded', function() {
                initializeQuranReader();
            });
            
            // Direct fallback in case the event doesn't fire
            setTimeout(() => {
                if (window.completeQuranAllSurahs && Object.keys(window.completeQuranAllSurahs).length >= 114) {
                    console.log('‚úÖ Direct fallback: Using completeQuranAllSurahs');
                    initializeQuranReader();
                } else {
                    console.error('‚ùå Fallback failed: No complete Quran data available');
                    showError('Quran data not available. Please refresh the page.');
                }
            }, 1000);
        });

        function initializeQuranReader() {
            // Direct load from completeQuranAllSurahs which has all 114 surahs
            let quranData = window.completeQuranAllSurahs;

            // Debug logging
            console.log('üîç Initializing Quran Reader...');
            console.log('completeQuranAllSurahs:', window.completeQuranAllSurahs ? Object.keys(window.completeQuranAllSurahs).length + ' surahs' : 'not found');
            console.log('Total surahs in selected data:', quranData ? Object.keys(quranData).length : 0);

            // Force load if data exists
            if (!quranData && window.completeQuranFull) {
                console.log('‚ö†Ô∏è Using fallback data: completeQuranFull');
                quranData = window.completeQuranFull;
            }

            if (quranData && Object.keys(quranData).length > 0) {
                surahData = quranData;
                setupSurahSelector();
                showSurah(1);
                
                setTimeout(() => {
                    // Verify complete Quran is loaded from any source
                    const loadedSurahs = Object.keys(surahData).map(Number).sort((a, b) => a - b);
                    const hasAll114 = loadedSurahs.length === 114 && loadedSurahs.every((num, index) => num === index + 1);

                    if (hasAll114) {
                        showNotification('Complete Holy Quran loaded! All 114 surahs verified.', 'success');
                    } else {
                        showNotification(`Quran loaded with ${loadedSurahs.length} surahs!`, 'success');
                    }
                    
                    // Run sacred verification automatically
                    setTimeout(() => {
                        console.log('ü§≤ Performing sacred verification of complete Quran...');

                        const verificationResults = verifyCompleteQuran();

                        if (verificationResults.success) {
                            console.log('üéâ ü§≤ SUBHANALLAH! Sacred verification successful! ü§≤ üéâ');

                            // Show success notification
                            setTimeout(() => {
                                showNotification('ü§≤ Complete Holy Quran verified successfully! All 114 surahs complete! ü§≤', 'success');
                            }, 1000);
                        } else {
                            console.warn('‚ö†Ô∏è Sacred verification found issues - check console for details');

                            // Show warning notification
                            setTimeout(() => {
                                showNotification('‚ö†Ô∏è Some surahs may need verification. Check console.', 'warning');
                            }, 1000);
                        }

                    }, 2000);
                }, 1000);
            } else {
                showError('Quran data not found. Please refresh the page.');
            }
        }

        function setupSurahSelector() {
            const surahSelect = document.getElementById('surahSelect');
            surahSelect.innerHTML = '';

            let optionsCreated = 0;
            let missingSurahs = [];

            for (let i = 1; i <= 114; i++) {
                if (surahData[i]) {
                    const option = document.createElement('option');
                    option.value = i;
                    const surah = surahData[i];
                    option.textContent = `${i}. ${surah.name} (${surah.english})`;
                    surahSelect.appendChild(option);
                    optionsCreated++;
                } else {
                    missingSurahs.push(i);
                }
            }

            console.log(`‚úÖ Surah selector setup: ${optionsCreated} options created`);
            if (missingSurahs.length > 0) {
                console.warn(`‚ö†Ô∏è Missing surahs in selector: ${missingSurahs.join(', ')}`);
            }
            
            surahSelect.addEventListener('change', function() {
                showSurah(parseInt(this.value));
            });
        }

        function showSurah(surahNumber) {
            currentSurah = parseInt(surahNumber);
            const surah = surahData[currentSurah];
            
            console.log(`Loading Surah ${surahNumber}:`, surah);
            
            if (!surah) {
                showError('Surah not found');
                return;
            }

            const content = document.getElementById('quranContent');
            
            // Generate verses HTML
            let versesHTML = '';
            let verseCount = 0;

            if (surah.verses_data && surah.verses_data.length > 0) {
                console.log(`ü§≤ Surah ${surahNumber} (${surah.name}) has ${surah.verses_data.length} verses total`);

                // Process verses in chunks to avoid browser limits
                const chunkSize = 50; // Process 50 verses at a time
                let processedVerses = 0;

                for (let i = 0; i < surah.verses_data.length; i += chunkSize) {
                    const chunk = surah.verses_data.slice(i, i + chunkSize);
                    console.log(`Processing verses ${i + 1}-${Math.min(i + chunkSize, surah.verses_data.length)} of ${surah.verses_data.length}...`);

                    chunk.forEach((verse, chunkIndex) => {
                        try {
                            const actualIndex = i + chunkIndex;
                            if (verse && verse.arabic && verse.arabic.trim() !== '') {
                                versesHTML += generateVerseHTML(verse, actualIndex + 1);
                                verseCount++;
                                processedVerses++;
                            } else {
                                console.warn(`Verse ${actualIndex + 1} missing Arabic text in Surah ${surahNumber}`);
                            }
                        } catch (error) {
                            console.error(`Error processing verse ${actualIndex + 1} in Surah ${surahNumber}:`, error);
                        }
                    });
                }

                console.log(`‚úÖ Generated HTML for ${verseCount}/${surah.verses_data.length} verses in Surah ${surahNumber}`);

                // Final verification
                if (verseCount !== surah.verses_data.length) {
                    console.error(`‚ùå VERSE COUNT MISMATCH: Generated ${verseCount} verses but expected ${surah.verses_data.length}`);
                    console.error('This indicates some verses are missing Arabic text or have processing errors');
                } else {
                    console.log(`üéâ All ${verseCount} verses processed successfully for Surah ${surahNumber}!`);
                }

            } else {
                console.error(`‚ùå Surah ${surahNumber} has no verses_data!`);
                versesHTML = '<div class="error">No verses found for this surah</div>';
            }

            const surahHTML = `
                <div class="surah-container">
                    <div class="surah-header">
                        <div class="surah-name-arabic">${surah.arabic}</div>
                        <div class="surah-name-english">${surah.name} (${surah.english})</div>
                        <div class="surah-info">
                            ${surah.type} ‚Ä¢ ${surah.verses} verses
                            ${surah.juz ? `‚Ä¢ Juz ${Array.isArray(surah.juz) ? surah.juz.join(', ') : surah.juz}` : ''}
                        </div>
                    </div>
                    
                    ${currentSurah !== 9 ? `
                        <div class="bismillah">
                            <div class="arabic-text">ÿ®Ÿêÿ≥ŸíŸÖŸê ÿßŸÑŸÑŸéŸëŸáŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸíŸÖŸéŸ∞ŸÜŸê ÿßŸÑÿ±ŸéŸëÿ≠ŸêŸäŸÖŸê</div>
                            <div class="transliteration">Bismillahi-r-Rahmani-r-Raheem</div>
                            <div class="translation">In the name of Allah, the Entirely Merciful, the Especially Merciful.</div>
                        </div>
                    ` : ''}
                    
                    <div class="verses-container">
                        ${versesHTML}
                    </div>
                </div>
            `;
            
            content.innerHTML = surahHTML;
            updateNavigationButtons();

            // Verify DOM was updated correctly
            setTimeout(() => {
                const displayedVerses = document.querySelectorAll('.verse-block').length;
                console.log(`üìä DOM verification: ${displayedVerses} verses displayed in browser`);
                console.log(`üìä Expected verses: ${surah.verses}, Generated verses: ${verseCount}, Displayed verses: ${displayedVerses}`);

                if (displayedVerses !== verseCount) {
                    console.error(`‚ùå DOM ERROR: Generated ${verseCount} verses but only ${displayedVerses} are displayed!`);
                } else if (displayedVerses === surah.verses) {
                    console.log(`üéâ SUCCESS: All ${displayedVerses} verses of Surah ${surahNumber} displayed perfectly!`);
                } else {
                    console.warn(`‚ö†Ô∏è PARTIAL DISPLAY: ${displayedVerses}/${surah.verses} verses shown`);
                }
            }, 100);
            
            // Smooth scroll to content
            content.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function generateVerseHTML(verse, verseNumber) {
            return `
                <div class="verse-block">
                    <div class="verse-number">${verseNumber}</div>
                    <div class="verse-content">
                        <div class="arabic-verse">${verse.arabic}</div>
                        <div class="transliteration">${verse.transliteration}</div>
                        <div class="english-translation">${verse.translation}</div>
                    </div>
                </div>
            `;
        }

        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevSurah');
            const nextBtn = document.getElementById('nextSurah');
            const surahSelect = document.getElementById('surahSelect');
            
            prevBtn.disabled = currentSurah <= 1;
            nextBtn.disabled = currentSurah >= 114;
            surahSelect.value = currentSurah;
            
            updatePaginationButtons();
        }
        
        function updatePaginationButtons() {
            const prevPageBtn = document.getElementById('prevPageBtn');
            const nextPageBtn = document.getElementById('nextPageBtn');
            const pageInfo = document.getElementById('pageInfo');
            
            prevPageBtn.disabled = currentPage <= 1;
            nextPageBtn.disabled = currentPage >= totalPages;
            pageInfo.textContent = `Surah ${currentPage} of ${totalPages}`;
        }

        function previousSurah() {
            if (currentSurah > 1) {
                currentSurah--;
                currentPage = currentSurah; // Keep in sync
                showSurah(currentSurah);
                updatePaginationButtons();
            }
        }

        function nextSurah() {
            if (currentSurah < 114) {
                currentSurah++;
                currentPage = currentSurah; // Keep in sync
                showSurah(currentSurah);
                updatePaginationButtons();
            }
        }
        
        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                goToPage(currentPage);
            }
        }
        
        function nextPage() {
            if (currentPage < totalPages) {
                currentPage++;
                goToPage(currentPage);
            }
        }
        
        function goToPage(pageNumber) {
            // Each page shows a complete surah (1-114)
            const surahFromPage = Math.min(pageNumber, 114);
            currentSurah = surahFromPage;
            currentPage = surahFromPage; // Keep page and surah in sync
            showSurah(currentSurah);
            updatePaginationButtons();
            
            // Scroll to top of content
            const content = document.getElementById('quranContent');
            if (content) {
                content.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? 'var(--light-green)' : type === 'error' ? 'var(--error-red, #ef4444)' : 'var(--gold)'};
                color: ${type === 'success' ? 'var(--dark-green)' : 'white'};
                padding: 1rem 1.5rem;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
                z-index: 10000;
                font-weight: 500;
                max-width: 300px;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => notification.style.transform = 'translateX(0)', 100);
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        function showError(message) {
            showNotification(message, 'error');
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                if (e.shiftKey) {
                    // Shift + Left Arrow for previous page
                    previousPage();
                } else if (currentSurah > 1) {
                    // Left Arrow for previous surah
                    previousSurah();
                }
            } else if (e.key === 'ArrowRight') {
                if (e.shiftKey) {
                    // Shift + Right Arrow for next page
                    nextPage();
                } else if (currentSurah < 114) {
                    // Right Arrow for next surah
                    nextSurah();
                }
            }
        });






        // Systematic verification function for sacred work
        function verifyCompleteQuran() {
            console.log('ü§≤ Starting Systematic Quran Verification - Sacred Work ü§≤');
            console.log('=' .repeat(60));

            if (!window.completeQuranAllSurahs) {
                console.error('‚ùå CRITICAL: completeQuranAllSurahs not loaded!');
                return { success: false, error: 'Data not loaded' };
            }

            const totalSurahs = Object.keys(window.completeQuranAllSurahs).length;
            console.log(`üìä Total Surahs Available: ${totalSurahs}/114`);

            if (totalSurahs !== 114) {
                console.error(`‚ùå CRITICAL: Expected 114 surahs, found ${totalSurahs}`);
                return { success: false, error: `Wrong count: ${totalSurahs}/114` };
            }

            let verifiedSurahs = 0;
            let missingSurahs = [];
            let incompleteSurahs = [];
            let brokenSurahs = [];

            console.log('\nüîç Systematically verifying each surah...');

            for (let surahNum = 1; surahNum <= 114; surahNum++) {
                const surah = window.completeQuranAllSurahs[surahNum];

                if (!surah) {
                    console.error(`‚ùå Surah ${surahNum}: MISSING completely!`);
                    missingSurahs.push(surahNum);
                    continue;
                }

                // Check basic structure
                if (!surah.name || !surah.arabic || !surah.english) {
                    console.error(`‚ùå Surah ${surahNum}: Missing basic metadata`);
                    brokenSurahs.push(surahNum);
                    continue;
                }

                // Check verses
                if (!surah.verses_data || surah.verses_data.length === 0) {
                    console.error(`‚ùå Surah ${surahNum} (${surah.name}): No verses!`);
                    incompleteSurahs.push(surahNum);
                    continue;
                }

                // Verify each verse has required content
                let verseIssues = 0;
                surah.verses_data.forEach((verse, index) => {
                    if (!verse.arabic || verse.arabic.trim() === '') verseIssues++;
                    if (!verse.transliteration || verse.transliteration.trim() === '') verseIssues++;
                    if (!verse.translation || verse.translation.trim() === '') verseIssues++;
                });

                if (verseIssues > 0) {
                    console.warn(`‚ö†Ô∏è Surah ${surahNum} (${surah.name}): ${verseIssues} verse issues`);
                    incompleteSurahs.push(surahNum);
                } else {
                    console.log(`‚úÖ Surah ${surahNum} (${surah.name}): ${surah.verses_data.length} verses - Complete`);
                    verifiedSurahs++;
                }

                // Progress indicator
                if (surahNum % 10 === 0) {
                    console.log(`üìä Progress: ${surahNum}/114 surahs verified...`);
                }
            }

            console.log('\n' + '='.repeat(60));
            console.log('ü§≤ SACRED VERIFICATION RESULTS ü§≤');
            console.log('='.repeat(60));

            console.log(`‚úÖ Verified Surahs: ${verifiedSurahs}/114`);
            console.log(`‚ùå Missing Surahs: ${missingSurahs.length}`);
            console.log(`‚ö†Ô∏è Incomplete Surahs: ${incompleteSurahs.length}`);
            console.log(`üíî Broken Surahs: ${brokenSurahs.length}`);

            if (missingSurahs.length > 0) {
                console.error('üö® CRITICAL - Missing Surahs:', missingSurahs);
            }

            if (brokenSurahs.length > 0) {
                console.error('üíî Broken Surahs:', brokenSurahs);
            }

            if (incompleteSurahs.length > 0) {
                console.warn('‚ö†Ô∏è Incomplete Surahs:', incompleteSurahs);
            }

            const isComplete = missingSurahs.length === 0 && brokenSurahs.length === 0 && verifiedSurahs === 114;

            if (isComplete) {
                console.log('\nüéâ ü§≤ SUBHANALLAH! COMPLETE QURAN IS PERFECT! ü§≤ üéâ');
                console.log('‚úÖ All 114 surahs verified and complete');
                console.log('‚úÖ Every verse has Arabic, transliteration, and translation');
                console.log('‚úÖ Sacred work completed successfully');
                console.log('ü§≤ Alhamdulillah! ü§≤');
            } else {
                console.error('\nüí• SACRED WORK INCOMPLETE - ISSUES FOUND üí•');
                console.error('‚ùå Some surahs are missing or incomplete');
                console.error('ü§≤ Please fix these issues for the complete Quran ü§≤');
            }

            return {
                success: isComplete,
                totalSurahs: 114,
                verifiedSurahs,
                missingSurahs,
                incompleteSurahs,
                brokenSurahs
            };
        }

        // Function to check data quality for a specific surah
        function checkSurahDataQuality(surahNumber) {
            const surah = window.completeQuranAllSurahs[surahNumber];
            if (!surah) {
                console.error(`‚ùå Surah ${surahNumber} not found in data!`);
                return false;
            }

            console.log(`üîç Checking data quality for Surah ${surahNumber} (${surah.name})`);
            console.log(`Expected verses: ${surah.verses}`);
            console.log(`Actual verses_data length: ${surah.verses_data ? surah.verses_data.length : 'undefined'}`);

            if (!surah.verses_data || surah.verses_data.length === 0) {
                console.error(`‚ùå No verses_data found for Surah ${surahNumber}!`);
                return false;
            }

            let completeVerses = 0;
            let incompleteVerses = 0;

            surah.verses_data.forEach((verse, index) => {
                const verseNum = index + 1;
                const hasArabic = verse && verse.arabic && verse.arabic.trim() !== '';
                const hasTransliteration = verse && verse.transliteration && verse.transliteration.trim() !== '';
                const hasTranslation = verse && verse.translation && verse.translation.trim() !== '';

                if (hasArabic && hasTransliteration && hasTranslation) {
                    completeVerses++;
                } else {
                    incompleteVerses++;
                    console.warn(`‚ö†Ô∏è Verse ${verseNum} incomplete: Arabic=${hasArabic}, Transliteration=${hasTransliteration}, Translation=${hasTranslation}`);
                }
            });

            console.log(`‚úÖ Complete verses: ${completeVerses}`);
            console.log(`‚ö†Ô∏è Incomplete verses: ${incompleteVerses}`);

            return {
                totalVerses: surah.verses_data.length,
                completeVerses,
                incompleteVerses,
                isComplete: completeVerses === surah.verses_data.length
            };
        }

        // Function to fix verse display issues
        function fixVerseDisplay(surahNumber) {
            console.log(`üîß Attempting to fix verse display for Surah ${surahNumber}`);

            // Check data quality
            const quality = checkSurahDataQuality(surahNumber);
            if (!quality.isComplete) {
                console.error(`‚ùå Cannot fix: Surah ${surahNumber} has incomplete data`);
                return false;
            }

            // Force reload the surah
            showSurah(surahNumber);
            console.log(`‚úÖ Reloaded Surah ${surahNumber} - should now show all ${quality.totalVerses} verses`);
            return true;
        }

        // Function to test specific surah display
        function testSurahDisplay(surahNumber) {
            console.log(`üß™ Testing Surah ${surahNumber} display...`);

            const surah = window.completeQuranAllSurahs[surahNumber];
            if (!surah) {
                console.error(`‚ùå Surah ${surahNumber} not found in data!`);
                return;
            }

            console.log(`üìä Surah ${surahNumber} (${surah.name}) data:`);
            console.log(`- Expected verses: ${surah.verses}`);
            console.log(`- verses_data length: ${surah.verses_data ? surah.verses_data.length : 'undefined'}`);

            if (surah.verses_data) {
                // Check first few verses
                console.log('üîç First 3 verses:');
                for (let i = 0; i < Math.min(3, surah.verses_data.length); i++) {
                    const verse = surah.verses_data[i];
                    console.log(`Verse ${i + 1}: Arabic=${verse.arabic ? '‚úÖ' : '‚ùå'}, Transliteration=${verse.transliteration ? '‚úÖ' : '‚ùå'}, Translation=${verse.translation ? '‚úÖ' : '‚ùå'}`);
                }

                // Check last few verses
                console.log('üîç Last 3 verses:');
                for (let i = Math.max(0, surah.verses_data.length - 3); i < surah.verses_data.length; i++) {
                    const verse = surah.verses_data[i];
                    console.log(`Verse ${i + 1}: Arabic=${verse.arabic ? '‚úÖ' : '‚ùå'}, Transliteration=${verse.transliteration ? '‚úÖ' : '‚ùå'}, Translation=${verse.translation ? '‚úÖ' : '‚ùå'}`);
                }
            }

            // Now load the surah and see what gets displayed
            console.log('üì∫ Loading surah for display...');
            showSurah(surahNumber);

            // Check the DOM after a short delay
            setTimeout(() => {
                const verseBlocks = document.querySelectorAll('.verse-block');
                console.log(`üìä DOM shows ${verseBlocks.length} verse blocks displayed`);
                console.log(`üìä Expected ${surah.verses} verses, displayed ${verseBlocks.length} verses`);

                if (verseBlocks.length !== surah.verses) {
                    console.error(`‚ùå MISMATCH: Expected ${surah.verses} verses, but only ${verseBlocks.length} are displayed!`);
                } else {
                    console.log('‚úÖ All verses displayed correctly!');
                }
            }, 500);
        }

        // Function to diagnose verse display issues
        function diagnoseVerseDisplay() {
            console.log('üîç DIAGNOSING VERSE DISPLAY ISSUE');
            console.log('==================================');

            // Check current surah
            console.log(`Current surah: ${currentSurah}`);
            const currentSurahData = window.completeQuranAllSurahs[currentSurah];

            if (!currentSurahData) {
                console.error(`‚ùå Current surah ${currentSurah} not found in data!`);
                return;
            }

            console.log(`Surah ${currentSurah} (${currentSurahData.name})`);
            console.log(`- Expected verses: ${currentSurahData.verses}`);
            console.log(`- verses_data length: ${currentSurahData.verses_data ? currentSurahData.verses_data.length : 'undefined'}`);

            // Check DOM
            const verseBlocks = document.querySelectorAll('.verse-block');
            console.log(`- Verse blocks in DOM: ${verseBlocks.length}`);

            // Check if verses_data exists and has content
            if (currentSurahData.verses_data) {
                console.log('‚úÖ verses_data exists');

                // Sample first few verses
                for (let i = 0; i < Math.min(3, currentSurahData.verses_data.length); i++) {
                    const verse = currentSurahData.verses_data[i];
                    console.log(`Verse ${i + 1}: Arabic length = ${verse.arabic ? verse.arabic.length : 'undefined'}`);
                }

                // Check for empty verses
                const emptyVerses = currentSurahData.verses_data.filter(v => !v || !v.arabic || v.arabic.trim() === '');
                console.log(`Empty/missing verses: ${emptyVerses.length}`);

                if (emptyVerses.length > 0) {
                    console.error('‚ùå FOUND EMPTY VERSES - This could be the issue!');
                    emptyVerses.forEach((verse, index) => {
                        const actualIndex = currentSurahData.verses_data.indexOf(verse);
                        console.error(`Empty verse at index ${actualIndex}`);
                    });
                }

            } else {
                console.error('‚ùå verses_data is missing!');
            }

            // Check HTML content length
            const quranContent = document.getElementById('quranContent');
            if (quranContent) {
                console.log(`DOM content length: ${quranContent.innerHTML.length} characters`);
            }

            console.log('==================================');
            console.log('DIAGNOSIS COMPLETE');
            console.log('==================================');
        }

        // Make functions available globally
        window.showSurah = showSurah;
        window.previousSurah = previousSurah;
        window.nextSurah = nextSurah;
        window.previousPage = previousPage;
        window.nextPage = nextPage;
        window.verifyCompleteQuran = verifyCompleteQuran;
        window.checkSurahDataQuality = checkSurahDataQuality;
        window.fixVerseDisplay = fixVerseDisplay;
        window.testSurahDisplay = testSurahDisplay;
        window.diagnoseVerseDisplay = diagnoseVerseDisplay;
    </script>
</body>
</html>