<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create New Topic - Islamic Learning Companion</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    <style>
        .create-topic-page {
            min-height: 100vh;
            background: linear-gradient(135deg, var(--dark-green), var(--darker-green));
            padding: 2rem 0;
        }
        
        .create-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        .create-header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .create-title {
            color: var(--gold);
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        
        .create-subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }
        
        .create-form {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            padding: 3rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 2rem;
        }
        
        .form-group {
            margin-bottom: 2rem;
        }
        
        .form-group label {
            display: block;
            color: var(--white);
            margin-bottom: 0.8rem;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 1rem;
            color: var(--white);
            font-size: 1rem;
            font-family: inherit;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: var(--gold);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: var(--text-secondary);
        }
        
        .form-group textarea {
            min-height: 200px;
            resize: vertical;
        }
        
        .form-group small {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: block;
        }
        
        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .category-option {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .category-option:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--light-green);
        }
        
        .category-option.selected {
            background: rgba(212, 175, 55, 0.2);
            border-color: var(--gold);
        }
        
        .category-icon {
            font-size: 2rem;
            color: var(--light-green);
            margin-bottom: 0.8rem;
        }
        
        .category-option.selected .category-icon {
            color: var(--gold);
        }
        
        .category-name {
            color: var(--white);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .category-description {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1rem;
        }
        
        .btn-primary {
            background: var(--gold);
            color: var(--dark-green);
        }
        
        .btn-primary:hover {
            background: var(--gold-light);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--white);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .preview-section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 2rem;
            margin-top: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .preview-title {
            color: var(--gold);
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .preview-content {
            color: var(--white);
            line-height: 1.6;
        }
        
        .guidelines {
            background: rgba(74, 155, 110, 0.1);
            border: 1px solid rgba(74, 155, 110, 0.3);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .guidelines h3 {
            color: var(--light-green);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .guidelines ul {
            color: var(--text-secondary);
            line-height: 1.8;
            padding-left: 1.5rem;
        }
        
        .guidelines li {
            margin-bottom: 0.5rem;
        }
        
        .character-count {
            text-align: right;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 0.5rem;
        }
        
        .character-count.warning {
            color: var(--gold);
        }
        
        .character-count.error {
            color: #ff6b6b;
        }
        
        @media (max-width: 768px) {
            .create-container {
                padding: 0 1rem;
            }
            
            .create-form {
                padding: 2rem 1.5rem;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            .category-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-mosque"></i>
                <span>Islamic Learning Companion</span>
            </div>
            <div class="nav-menu">
                <a href="index.html" class="nav-link">Home</a>
                <a href="subjects.html" class="nav-link">Subjects</a>
                <a href="what-is-islam.html" class="nav-link">About Islam</a>
                <a href="community-board.html" class="nav-link active">Community</a>
                <button class="nav-btn" onclick="window.location.href='subjects.html'">Get Started</button>
            </div>
        </div>
    </nav>

    <!-- Create Topic Page -->
    <div class="create-topic-page">
        <div class="create-container">
            <!-- Header -->
            <div class="create-header">
                <h1 class="create-title">
                    <i class="fas fa-plus-circle"></i> Start New Discussion
                </h1>
                <p class="create-subtitle">Share your thoughts, ask questions, or start a meaningful conversation with the community</p>
            </div>

            <!-- Guidelines -->
            <div class="guidelines">
                <h3><i class="fas fa-info-circle"></i> Community Guidelines</h3>
                <ul>
                    <li>Be respectful and kind to all members</li>
                    <li>Stay on topic and contribute meaningfully</li>
                    <li>Use authentic Islamic sources when sharing information</li>
                    <li>Help new Muslims with patience and understanding</li>
                    <li>Report inappropriate content to moderators</li>
                    <li>Keep discussions focused on Islamic topics</li>
                </ul>
            </div>

            <!-- Create Form -->
            <form class="create-form" onsubmit="submitTopic(event)">
                <!-- Topic Title -->
                <div class="form-group">
                    <label for="topic-title">Topic Title *</label>
                    <input type="text" id="topic-title" placeholder="Enter a clear, descriptive title for your topic" required maxlength="200">
                    <small>Be specific and descriptive to help others understand your topic</small>
                    <div class="character-count" id="title-count">0/200</div>
                </div>

                <!-- Category Selection -->
                <div class="form-group">
                    <label>Category *</label>
                    <div class="category-grid">
                        <div class="category-option" data-category="quran" onclick="selectCategory('quran')">
                            <div class="category-icon">
                                <i class="fas fa-book-quran"></i>
                            </div>
                            <div class="category-name">Quran & Tafseer</div>
                            <div class="category-description">Discussion about Quranic verses and interpretations</div>
                        </div>
                        
                        <div class="category-option" data-category="hadith" onclick="selectCategory('hadith')">
                            <div class="category-icon">
                                <i class="fas fa-quote-left"></i>
                            </div>
                            <div class="category-name">Hadith & Sunnah</div>
                            <div class="category-description">Authentic hadiths and Prophet's teachings</div>
                        </div>
                        
                        <div class="category-option" data-category="prayer" onclick="selectCategory('prayer')">
                            <div class="category-icon">
                                <i class="fas fa-hands-praying"></i>
                            </div>
                            <div class="category-name">Prayer & Worship</div>
                            <div class="category-description">Salah, dua, and other forms of worship</div>
                        </div>
                        
                        <div class="category-option" data-category="new-muslims" onclick="selectCategory('new-muslims')">
                            <div class="category-icon">
                                <i class="fas fa-heart"></i>
                            </div>
                            <div class="category-name">New Muslims</div>
                            <div class="category-description">Support and guidance for new converts</div>
                        </div>
                        
                        <div class="category-option" data-category="general" onclick="selectCategory('general')">
                            <div class="category-icon">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="category-name">General Discussion</div>
                            <div class="category-description">General Islamic topics and community chat</div>
                        </div>
                    </div>
                </div>

                <!-- Topic Content -->
                <div class="form-group">
                    <label for="topic-content">Topic Content *</label>
                    <textarea id="topic-content" placeholder="Share your thoughts, questions, or insights. Be detailed and engaging to encourage meaningful discussion..." required maxlength="5000"></textarea>
                    <small>Include relevant details, questions, or points for discussion. You can use basic formatting like **bold** and *italic*.</small>
                    <div class="character-count" id="content-count">0/5000</div>
                </div>

                <!-- Tags (Optional) -->
                <div class="form-group">
                    <label for="topic-tags">Tags (Optional)</label>
                    <input type="text" id="topic-tags" placeholder="e.g., quran, prayer, ramadan, new-muslim (separate with commas)">
                    <small>Add relevant tags to help others find your topic</small>
                </div>

                <!-- Preview Section -->
                <div class="preview-section" id="preview-section" style="display: none;">
                    <h3 class="preview-title">Preview</h3>
                    <div class="preview-content" id="preview-content"></div>
                </div>

                <!-- Form Actions -->
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="cancelTopic()">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                    <button type="button" class="btn btn-secondary" onclick="togglePreview()">
                        <i class="fas fa-eye"></i> Preview
                    </button>
                    <button type="submit" class="btn btn-primary" id="submit-btn">
                        <i class="fas fa-paper-plane"></i> Create Topic
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/language-config.js"></script>
    <script src="js/translation-manager.js"></script>
    <script src="js/auto-moderation.js"></script>
    <script>
        // Create Topic Functionality
        let selectedCategory = null;
        let isPreviewVisible = false;

        // Initialize create topic page
        document.addEventListener('DOMContentLoaded', function() {
            setupFormValidation();
            setupCharacterCounters();
        });

        // Setup form validation
        function setupFormValidation() {
            const titleInput = document.getElementById('topic-title');
            const contentInput = document.getElementById('topic-content');
            const submitBtn = document.getElementById('submit-btn');

            function validateForm() {
                const isValid = titleInput.value.trim().length > 0 && 
                              contentInput.value.trim().length > 0 && 
                              selectedCategory !== null;
                
                submitBtn.disabled = !isValid;
            }

            titleInput.addEventListener('input', validateForm);
            contentInput.addEventListener('input', validateForm);
        }

        // Setup character counters
        function setupCharacterCounters() {
            const titleInput = document.getElementById('topic-title');
            const contentInput = document.getElementById('topic-content');
            const titleCount = document.getElementById('title-count');
            const contentCount = document.getElementById('content-count');

            titleInput.addEventListener('input', function() {
                const count = this.value.length;
                titleCount.textContent = `${count}/200`;
                
                if (count > 180) {
                    titleCount.className = 'character-count warning';
                } else if (count > 200) {
                    titleCount.className = 'character-count error';
                } else {
                    titleCount.className = 'character-count';
                }
            });

            contentInput.addEventListener('input', function() {
                const count = this.value.length;
                contentCount.textContent = `${count}/5000`;
                
                if (count > 4500) {
                    contentCount.className = 'character-count warning';
                } else if (count > 5000) {
                    contentCount.className = 'character-count error';
                } else {
                    contentCount.className = 'character-count';
                }
            });
        }

        // Select category
        function selectCategory(category) {
            selectedCategory = category;
            
            // Remove selected class from all options
            document.querySelectorAll('.category-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selected class to clicked option
            event.currentTarget.classList.add('selected');
            
            // Validate form
            validateForm();
        }

        // Toggle preview
        function togglePreview() {
            const previewSection = document.getElementById('preview-section');
            const previewContent = document.getElementById('preview-content');
            const title = document.getElementById('topic-title').value;
            const content = document.getElementById('topic-content').value;
            
            if (!isPreviewVisible) {
                previewContent.innerHTML = `
                    <h4 style="color: var(--gold); margin-bottom: 1rem;">${title || 'Untitled Topic'}</h4>
                    <p style="white-space: pre-wrap;">${content || 'No content yet...'}</p>
                `;
                previewSection.style.display = 'block';
                isPreviewVisible = true;
            } else {
                previewSection.style.display = 'none';
                isPreviewVisible = false;
            }
        }

        // Submit topic
        function submitTopic(event) {
            event.preventDefault();
            
            const title = document.getElementById('topic-title').value.trim();
            const content = document.getElementById('topic-content').value.trim();
            const tags = document.getElementById('topic-tags').value.trim();
            
            if (!title || !content || !selectedCategory) {
                alert('Please fill in all required fields');
                return;
            }
            
            // In a real app, this would submit to the server
            console.log('Submitting topic:', {
                title,
                content,
                category: selectedCategory,
                tags: tags.split(',').map(tag => tag.trim()).filter(tag => tag)
            });
            
            // Show success message
            alert('Topic created successfully! Redirecting to community board...');
            
            // Redirect to community board
            setTimeout(() => {
                window.location.href = 'community-board.html';
            }, 1500);
        }

        // Cancel topic creation
        function cancelTopic() {
            if (confirm('Are you sure you want to cancel? Your changes will be lost.')) {
                window.location.href = 'community-board.html';
            }
        }

        // Validate form
        function validateForm() {
            const titleInput = document.getElementById('topic-title');
            const contentInput = document.getElementById('topic-content');
            const submitBtn = document.getElementById('submit-btn');

            const isValid = titleInput.value.trim().length > 0 && 
                          contentInput.value.trim().length > 0 && 
                          selectedCategory !== null;
            
            submitBtn.disabled = !isValid;
        }

        // Auto-save draft (optional)
        function autoSaveDraft() {
            const draft = {
                title: document.getElementById('topic-title').value,
                content: document.getElementById('topic-content').value,
                category: selectedCategory,
                tags: document.getElementById('topic-tags').value,
                timestamp: Date.now()
            };
            
            localStorage.setItem('topic-draft', JSON.stringify(draft));
        }

        // Load draft (optional)
        function loadDraft() {
            const draft = localStorage.getItem('topic-draft');
            if (draft) {
                const data = JSON.parse(draft);
                document.getElementById('topic-title').value = data.title || '';
                document.getElementById('topic-content').value = data.content || '';
                document.getElementById('topic-tags').value = data.tags || '';
                
                if (data.category) {
                    selectCategory(data.category);
                }
            }
        }

        // Auto-save every 30 seconds
        setInterval(autoSaveDraft, 30000);

        // Load draft on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadDraft();
        });
    </script>
</body>
</html>
