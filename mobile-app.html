<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Islamic Companion">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1a4f3a">
    
    <title>Islamic Companion - Mobile App</title>
    
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* Mobile App Specific Styles - Using YOUR original design */
        .mobile-loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--gold);
            font-size: 1.2rem;
            z-index: 9999;
            text-align: center;
        }
        
        .mobile-loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(212, 175, 55, 0.3);
            border-top: 4px solid var(--gold);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Clean Mobile Navigation - Override everything */
        .mobile-app .navbar {
            display: none !important;
        }
        
        .mobile-navbar {
            background: rgba(26, 79, 58, 0.95);
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 1rem 0;
            transition: all 0.3s ease;
        }
        
        .mobile-nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .mobile-menu-button {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.75rem;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            font-size: 1rem;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .mobile-menu-button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }
        
        .mobile-nav-logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .mobile-nav-logo i {
            font-size: 1.5rem;
            color: var(--gold);
        }
        
        .mobile-nav-spacer {
            width: 45px; /* Same width as menu button for balance */
        }
        
        .mobile-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 1000;
        }
        
        .mobile-menu.active {
            display: block;
        }
        
        /* Force hide any old navigation elements */
        .mobile-app .navbar {
            display: none !important;
        }
        
        .mobile-app .nav-container,
        .mobile-app .nav-left,
        .mobile-app .nav-right,
        .mobile-app .back-btn,
        .mobile-app .mobile-menu-btn {
            display: none !important;
        }
        
        /* Hide any duplicate navigation */
        nav:not(.mobile-navbar) {
            display: none !important;
        }
        
        /* Mobile-specific adjustments to YOUR design */
        @media (max-width: 768px) {
            .hero-container {
                flex-direction: column;
                text-align: center;
                padding: 2rem 1rem;
                margin-top: 80px; /* Account for fixed navbar */
            }
            
            .hero-buttons {
                flex-direction: column;
                gap: 1rem;
                margin-top: 2rem;
            }
            
            .square-btn {
                width: 100%;
                max-width: 300px;
                margin: 0 auto;
            }
            
            .verse-display {
                margin-top: 2rem;
                padding: 1rem;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 10px;
            }
        }
    </style>
</head>
<body class="mobile-app">
    <!-- Loading Indicator -->
    <div class="mobile-loading" id="loadingIndicator">
        <div class="mobile-loading-spinner"></div>
        <div>Loading Islamic Companion...</div>
    </div>
    
    <!-- Mobile Navigation - Clean Single Button -->
    <nav class="mobile-navbar">
        <div class="mobile-nav-container">
            <button class="mobile-menu-button" onclick="toggleMobileMenu()" title="Menu">
                <i class="fas fa-bars"></i>
            </button>
            <div class="mobile-nav-logo">
                <i class="fas fa-mosque"></i>
                <span>Islamic Learning Companion</span>
            </div>
            <div class="mobile-nav-spacer"></div>
        </div>
        
        <!-- Mobile Menu -->
        <div class="mobile-menu" id="mobileMenu">
            <div class="mobile-menu-content">
                <div class="mobile-menu-section">
                    <div class="mobile-menu-header" onclick="toggleDropdown('homeDropdown')">
                        <span>Home</span>
                        <i class="fas fa-chevron-down" id="homeChevron"></i>
                    </div>
                    <div class="mobile-dropdown" id="homeDropdown">
                        <a href="index.html" class="mobile-nav-link active">Main Page</a>
                        <a href="complete-quran-reader.html" class="mobile-nav-link">Quran Reader</a>
                        <a href="hadith-search.html" class="mobile-nav-link">Hadith Search</a>
                        <a href="daily-companion.html" class="mobile-nav-link">Daily Companion</a>
                    </div>
                </div>
                <div class="mobile-menu-divider"></div>
                <a href="#" class="mobile-nav-link contact-link" onclick="showContactSheet()">Contact Us</a>
                <a href="#" class="mobile-nav-link donation-info" onclick="showDonationBreakdown()">What are donations used for?</a>
                <a href="#" class="mobile-nav-link developer-info" onclick="showDeveloperInfo()">Updates from the Developer</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-container">
            <div class="hero-content">
                <div class="dua-header">
                    <div class="dua-arabic">
                        <p class="arabic-text">رَبِّ زِدْنِي عِلْمًا نَافِعًا وَارْزُقْنِي فَهْمًا صَاحِبًا</p>
                        <p class="arabic-text">وَاجْعَلْ هَذَا العَمَلَ خَالِصًا لِوَجْهِكَ الكَرِيمِ</p>
                        <p class="arabic-text">وَنَفَعَ بِهِ أُمَّةَ مُحَمَّدٍ عَلَيْهِ الصَّلَاةُ وَالسَّلَام</p>
                    </div>
                </div>
                <div class="hero-buttons">
                    <button class="btn-primary square-btn" onclick="window.location.href='complete-quran-reader.html'">
                        <span class="quran-text">Holy Quran</span>
                    </button>
                    <button class="btn-primary square-btn" onclick="window.location.href='hadith-search.html'">
                        <span class="hadith-text">Hadiths</span>
                    </button>
                    <button class="btn-primary square-btn" onclick="window.location.href='daily-companion.html'">
                        <span class="companion-text">Daily Companion</span>
                    </button>
                    <div class="verse-display">
                        <p class="verse-arabic">ٱقْرَأْ بِٱسْمِ رَبِّكَ ٱلَّذِى خَلَقَ</p>
                        <p class="verse-transliteration">Iqra' bismi rabbikal-ladhi khalaq</p>
                        <p class="verse-translation">Read in the name of your Lord who created</p>
                        <p class="verse-reference">Surah Al-Alaq 96:1</p>
                    </div>
                </div>
            </div>
            <div class="hero-image">
            </div>
        </div>
    </section>

    <!-- Additional Content Section -->
    <section class="additional-content">
        <div class="container">
            <div class="content-grid">
                <div class="content-card">
                    <h3>Welcome to Your Islamic Journey</h3>
                    <p>Discover the beauty of Islamic teachings through our comprehensive learning platform. Whether you're a new Muslim or looking to deepen your understanding, we're here to support your spiritual growth.</p>
                </div>
                <div class="content-card">
                    <h3>Reliance on Authentic Sources & Openness to Correction</h3>
                    <p>We strive to draw our content solely from the Qur'an and authentic Sunnah, verified by qualified scholars. However, as humans are prone to error, we sincerely welcome any correction from our respected users. If you spot a mistake, please notify us via the "Contact Us" menu. We will review it and correct it, Insha'Allah. May Allah reward you for your nasihah (sincere advice).</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Building a Better Experience for You</h4>
                    <p>To provide you with the best possible app, we've started a complete rebuild! This ensures maximum functionality and ease of use for our community. Please note that features will return in phases as they are perfected.</p>
                    <p>Your patience is invaluable. For updates on our progress or to learn how you can help, see the "Message from the Developer" in the menu. Thank you for your support—Insha'Allah we will create something amazing together.</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Islamic Learning Companion. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Contact Sheet Modal -->
    <div class="contact-modal" id="contactModal">
        <div class="contact-modal-content">
            <div class="contact-modal-header">
                <h3>Contact Us</h3>
                <button class="contact-close" onclick="closeContactSheet()">&times;</button>
            </div>
            <div class="contact-modal-body">
                <p><strong>We Value Your Nasihah (Sincere Advice)</strong></p>
                <p>As believers are mirrors to one another, we warmly welcome your questions, suggestions, or any errors you may have found. Please reach out and may Allah reward you with good.</p>
                <div class="contact-info">
                    <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <div class="contact-details">
                            <strong>Email</strong>
                            <a href="mailto:nextelevenstudios@gmail.com" class="contact-email">nextelevenstudios@gmail.com</a>
                        </div>
                    </div>
                </div>
                <div class="contact-actions">
                    <button class="btn-primary" onclick="window.location.href='mailto:nextelevenstudios@gmail.com'">
                        <i class="fas fa-envelope"></i> Send Email
                    </button>
                    <button class="btn-secondary" onclick="copyEmail()">
                        <i class="fas fa-copy"></i> Copy Email
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Developer Modal -->
    <div class="developer-modal" id="developerModal">
        <div class="developer-modal-content">
            <div class="developer-modal-header">
                <h3>Updates from the Developer</h3>
                <button class="developer-modal-close" onclick="closeDeveloperModal()">&times;</button>
            </div>
            <div class="developer-modal-body">
                <div class="developer-info">
                    <div class="donation-section">
                        <h4>Support the Vision: <a href="https://square.link/u/txN8sC1d" target="_blank" class="donation-link">Donate Here</a></h4>
                    </div>
                    
                    <!-- Recent Updates Section -->
                    <div class="updates-section">
                        <h4>Recent Updates</h4>
                        <div id="updatesList">
                            <!-- Updates will be dynamically loaded here -->
                        </div>
                    </div>
                    
                    <div class="bismillah">
                        <p class="arabic-text">بسم الله الرحمن الرحيم</p>
                    </div>
                    
                    <div class="greeting">
                        <p><strong>As-Salamu Alaikum Wa Rahmatullahi Wa Barakatuh,</strong></p>
                    </div>
                    
                    <div class="vision-section">
                        <p>I am reaching out to you today with a vision that lies at the intersection of our faith and the future—a vision to make the vast and beautiful knowledge of Islam accessible to every Muslim, for free, in the digital age.</p>
                        
                        <p>We are building a comprehensive digital platform designed to be a reliable fortress of authentic Islamic knowledge. This project aims to provide:</p>
                        
                        <ul>
                            <li><strong>A Complete Islamic Library:</strong> Integrating major texts from the Qur'an and the six authentic books of Hadith to trusted texts of Fiqh, Tafsir, and Islamic history—all in one place, verified by qualified scholars.</li>
                            <li><strong>AI-Powered Islamic Guidance:</strong> An intelligent assistant will provide scholarly-based answers to your questions, helping to combat misinformation with authentic, well-sourced knowledge.</li>
                            <li><strong>A Modern, Accessible Experience:</strong> A beautifully designed platform that works on any device, making learning seamless and engaging for everyone, everywhere.</li>
                        </ul>
                    </div>
                    
                    <div class="why-matters">
                        <h4>Why This Matters Now</h4>
                        <p>Our communities are struggling. Our youth are searching for answers online but often finding diluted or incorrect information. The deep, scholarly tradition of Islam is being lost in a sea of soundbites. This project is our answer: a dedicated effort to preserve our heritage and make it relevant and accessible for today and tomorrow.</p>
                    </div>
                    
                    <div class="work-progress">
                        <h4>A Work in Progress, By the Permission of Allah</h4>
                        <p>This application is currently in a beta rebuild phase. We are rebuilding from the ground up to ensure maximum functionality, reliability, and ease of use. This means features are being re-released gradually as they are perfected. Your patience and duas during this process are invaluable.</p>
                    </div>
                    
                    <div class="sadaqah-section">
                        <h4>Your Role in This Sadaqah Jariyah</h4>
                        <p>This project is a labor of love and a duty to our Ummah. To ensure it reaches its full potential and remains completely free, without any ads or subscriptions, we need your support.</p>
                        
                        <p><strong>100% of your donations</strong> (after standard payment processing fees) will be directed solely towards:</p>
                        <ul>
                            <li>Hosting the platform securely.</li>
                            <li>Development costs to complete and expand its features.</li>
                            <li>Ensuring it remains a free resource for all.</li>
                        </ul>
                        
                        <p>Your contribution is not just a donation; it is an investment in a <strong>Sadaqah Jariyah</strong>—a continuous charity that, God willing, will benefit millions of Muslims around the world for generations to come, and you will share in its reward.</p>
                    </div>
                    
                    <div class="join-us">
                        <h4>Join Us in Building This Legacy</h4>
                        <p class="hadith">The Prophet Muhammad (ﷺ) said, <em>"The best of people are those who are most beneficial to people."</em></p>
                        <p>Let us be among those who benefit others. Join me in this mission to empower the Ummah with knowledge.</p>
                        
                        <div class="support-section">
                            <p><strong>Support the development of this platform:</strong></p>
                            <a href="https://square.link/u/txN8sC1d" target="_blank" class="donation-link">Donate Here</a>
                        </div>
                        
                        <p>Please remember this project in your deepest and most sincere prayers.</p>
                    </div>
                    
                    <div class="signature">
                        <p><strong>Jazakum Allahu Khayran,</strong></p>
                        <p><strong>NextEleven Studios</strong><br>Developer</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Donation Breakdown Modal -->
    <div class="donation-modal" id="donationModal">
        <div class="donation-modal-content">
            <div class="donation-modal-header">
                <h3>Where Your Donation Goes</h3>
                <button class="donation-modal-close" onclick="closeDonationModal()">&times;</button>
            </div>
            <div class="donation-modal-body">
                <div class="donation-breakdown">
                    <div class="transparency-intro">
                        <div class="bismillah">
                            <p class="arabic-text">بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ</p>
                        </div>
                        <p><strong>Your Support is a Sadaqah Jariyah in the Path of Knowledge</strong></p>
                        <p class="quran-verse">"Who is it that would loan Allāh a goodly loan so He may multiply it for him many times over?" (Surah Al-Baqarah: 245)</p>
                        <p>Your contribution is far more than a donation; it is a virtuous loan to Allah (Qardh Hasan) and a direct investment in building a lasting infrastructure for authentic Islamic knowledge—preserving our Deen for the digital age.</p>
                        <p>Here is a precise breakdown of how your contributions are allocated:</p>
                    </div>
                    
                    <div class="cost-category">
                        <h4>1. Server Hosting & Infrastructure (The Digital Foundation)</h4>
                        <div class="cost-item">
                            <div class="cost-label">Current Basic Server:</div>
                            <div class="cost-amount">$48/month</div>
                            <div class="cost-description">This hosts the current beta version of the application.</div>
                        </div>
                        <div class="cost-item">
                            <div class="cost-label">Near-Future Scaling:</div>
                            <div class="cost-amount">$120-$200/month</div>
                            <div class="cost-description">As we add the Qur'an, Hadith libraries, and user accounts, we will immediately need a more powerful VPS (Virtual Private Server).</div>
                        </div>
                        <div class="cost-item">
                            <div class="cost-label">AI Assistant Server:</div>
                            <div class="cost-amount">$300-$500/month</div>
                            <div class="cost-description">To run the complex AI models that power the intelligent assistant, a dedicated, high-performance server is required.</div>
                        </div>
                    </div>
                    
                    <div class="cost-category">
                        <h4>2. Development Tools & Software (The Builder's Toolkit)</h4>
                        <div class="cost-item">
                            <div class="cost-label">Essential Software & APIs:</div>
                            <div class="cost-amount">$60-$100/day</div>
                            <div class="cost-description">Licenses for essential programming software, code libraries, AI APIs, and security tools are critical for professional development. This investment ensures the platform is built on a secure, stable, and modern foundation.</div>
                        </div>
                    </div>
                    
                    <div class="cost-category">
                        <h4>3. Development Time (A Full-Time Commitment)</h4>
                        <div class="cost-item">
                            <div class="cost-label">Full-Time Development:</div>
                            <div class="cost-amount">14-16 hours/day</div>
                            <div class="cost-description">I have left my job to dedicate myself completely to this project. Your support helps cover the essential living costs that allow me to continue this work full-time without having to abandon the project for other work. This ensures development continues uninterrupted.</div>
                        </div>
                    </div>
                    
                    <div class="cost-category">
                        <h4>4. Future Critical Expenses (Preparing for Growth)</h4>
                        <div class="cost-item">
                            <div class="cost-label">Mobile Apps:</div>
                            <div class="cost-amount">Variable</div>
                            <div class="cost-description">Costs for developer accounts (Apple App Store & Google Play Store) and build tools.</div>
                        </div>
                        <div class="cost-item">
                            <div class="cost-label">Security & Backup:</div>
                            <div class="cost-amount">Variable</div>
                            <div class="cost-description">Advanced security certificates, daily backups, and protection from cyber threats to keep user data and Islamic content safe.</div>
                        </div>
                        <div class="cost-item">
                            <div class="cost-label">Content Licensing:</div>
                            <div class="cost-amount">Variable</div>
                            <div class="cost-description">Fees associated with formally licensing certain authoritative translations and scholarly texts to ensure we distribute them legally and ethically.</div>
                        </div>
                        <div class="cost-item">
                            <div class="cost-label">Quality Assurance:</div>
                            <div class="cost-amount">Variable</div>
                            <div class="cost-description">In the future, funds may be used to bring on a part-time tester to help find bugs faster, ensuring a higher quality product for the Ummah.</div>
                        </div>
                    </div>
                    
                    <div class="transparency-pledge">
                        <h4>Our Pledge: 100% Transparency</h4>
                        <p><strong>100% of your donation</strong>, after Square's standard payment processing fee (2.9% + $0.30 per transaction), is dedicated solely to the above expenses. We are committed to no ads, no subscriptions, and no hidden costs.</p>
                        <p>Your donation, large or small, directly powers this mission. You are not just keeping a server online; you are enabling a developer to focus entirely on building a legacy for the Ummah.</p>
                    </div>
                    
                    <div class="support-section">
                        <h4>Support the Development:</h4>
                        <a href="https://square.link/u/txN8sC1d" target="_blank" class="donation-link">Donate Here</a>
                        <p class="prayer-request">May Allah reward you immensely for your support and trust. Please remember this project in your dua.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Essential JavaScript Dependencies with Error Handling -->
    <script>
        // Track which scripts loaded successfully
        window.scriptLoadStatus = {
            loaded: 0,
            total: 12,
            errors: []
        };
        
        function onScriptLoad() {
            window.scriptLoadStatus.loaded++;
            console.log(`Script loaded: ${window.scriptLoadStatus.loaded}/${window.scriptLoadStatus.total}`);
        }
        
        function onScriptError(scriptName) {
            window.scriptLoadStatus.errors.push(scriptName);
            console.warn(`Script failed to load: ${scriptName}`);
        }
    </script>
    
    <script src="js/language-config.js" onload="onScriptLoad()" onerror="onScriptError('language-config')"></script>
    <script src="js/translation-manager.js" onload="onScriptLoad()" onerror="onScriptError('translation-manager')"></script>
    <script src="js/secure-config.js" onload="onScriptLoad()" onerror="onScriptError('secure-config')"></script>
    <script src="js/local-config.js" onload="onScriptLoad()" onerror="onScriptError('local-config')"></script>
    <script src="js/complete-quran-data.js" onload="onScriptLoad()" onerror="onScriptError('complete-quran-data')"></script>
    <script src="hadiths.js" onload="onScriptLoad()" onerror="onScriptError('hadiths')"></script>
    <script src="js/comprehensive-islamic-knowledge.js" onload="onScriptLoad()" onerror="onScriptError('comprehensive-islamic-knowledge')"></script>
    <script src="js/comprehensive-islamic-knowledge-expanded.js" onload="onScriptLoad()" onerror="onScriptError('comprehensive-islamic-knowledge-expanded')"></script>
    <script src="js/extensive-islamic-knowledge.js" onload="onScriptLoad()" onerror="onScriptError('extensive-islamic-knowledge')"></script>
    <script src="js/specialized-islamic-knowledge.js" onload="onScriptLoad()" onerror="onScriptError('specialized-islamic-knowledge')"></script>
    <script src="js/detailed-quranic-hadith-database.js" onload="onScriptLoad()" onerror="onScriptError('detailed-quranic-hadith-database')"></script>
    <script src="js/rag-system.js" onload="onScriptLoad()" onerror="onScriptError('rag-system')"></script>
    <script src="script.js" onload="onScriptLoad()" onerror="onScriptError('script')"></script>
    
    <script>
        // Navigation Functions (from your original app)
        function goBack() {
            if (window.history.length > 1) {
                window.history.back();
            } else {
                window.location.href = 'index.html';
            }
        }
        
        // Mobile Menu Functions (from your original app)
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('active');
        }
        
        function toggleDropdown(dropdownId) {
            const dropdown = document.getElementById(dropdownId);
            const header = dropdown.previousElementSibling;
            const chevron = header.querySelector('i');
            
            dropdown.classList.toggle('active');
            header.classList.toggle('active');
        }

        // Close mobile menu when clicking outside
        document.addEventListener('click', function(event) {
            const mobileMenu = document.getElementById('mobileMenu');
            const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
            
            if (mobileMenu && mobileMenu.classList.contains('active') && 
                !mobileMenu.contains(event.target) && 
                !mobileMenuBtn.contains(event.target)) {
                mobileMenu.classList.remove('active');
            }
        });

        // Developer Info Function (from your original app)
        function showDeveloperInfo() {
            const developerModal = document.getElementById('developerModal');
            developerModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        // Contact Sheet Functions (from your original app)
        function showContactSheet() {
            const contactModal = document.getElementById('contactModal');
            contactModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeContactSheet() {
            const contactModal = document.getElementById('contactModal');
            contactModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function copyEmail() {
            navigator.clipboard.writeText('nextelevenstudios@gmail.com').then(function() {
                alert('Email address copied to clipboard!');
            }, function(err) {
                console.error('Could not copy text: ', err);
                alert('Could not copy email address. Please copy manually: nextelevenstudios@gmail.com');
            });
        }

        // Developer Modal Functions (from your original app)
        function closeDeveloperModal() {
            const developerModal = document.getElementById('developerModal');
            developerModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Donation Modal Functions (from your original app)
        function showDonationBreakdown() {
            const donationModal = document.getElementById('donationModal');
            donationModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeDonationModal() {
            const donationModal = document.getElementById('donationModal');
            donationModal.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Updates System (from your original app)
        const updates = [
            {
                date: "Today",
                updates: [
                    {
                        title: "Mobile App White Screen Issue Fixed - 2 Hours",
                        content: [
                            "🔧 Fixed white screen issue by adding proper JavaScript dependencies",
                            "✅ Restored original beautiful design and functionality",
                            "📱 Optimized for mobile devices while preserving your vision",
                            "🛡️ Added robust error handling to prevent future issues",
                            "✨ Maintained all original features and donation integration",
                            "🎯 App now works perfectly on mobile devices"
                        ],
                        type: "major",
                        hours: 2
                    }
                ],
                totalHours: 2
            }
        ];

        function loadUpdates() {
            const updatesList = document.getElementById('updatesList');
            if (!updatesList) return;

            updatesList.innerHTML = '';

            updates.forEach((dateGroup, index) => {
                const datePanel = document.createElement('div');
                datePanel.className = 'date-panel';
                
                const isFirst = index === 0;
                const panelId = `panel-${index}`;
                
                datePanel.innerHTML = `
                    <div class="date-header" onclick="togglePanel('${panelId}')">
                        <div class="date-info">
                            <h5 class="date-title">${dateGroup.date}</h5>
                            <span class="total-hours">${dateGroup.totalHours} hours</span>
                        </div>
                        <div class="date-stats">
                            <span class="update-count">${dateGroup.updates.length} updates</span>
                            <i class="fas fa-chevron-down panel-icon" id="icon-${panelId}"></i>
                        </div>
                    </div>
                    <div class="date-content" id="${panelId}" style="display: ${isFirst ? 'block' : 'none'}">
                        ${dateGroup.updates.map(update => `
                            <div class="update-item ${update.type}">
                                <div class="update-header">
                                    <h6 class="update-title">${update.title}</h6>
                                    <span class="update-hours">${update.hours}h</span>
                                </div>
                                <div class="update-content">
                                    <ul class="update-list">
                                        ${update.content.map(item => `<li>${item}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                updatesList.appendChild(datePanel);
            });
        }

        function togglePanel(panelId) {
            const panel = document.getElementById(panelId);
            const icon = document.getElementById(`icon-${panelId}`);
            
            if (panel.style.display === 'none') {
                panel.style.display = 'block';
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-up');
            } else {
                panel.style.display = 'none';
                icon.classList.remove('fa-chevron-up');
                icon.classList.add('fa-chevron-down');
            }
        }

        // Load updates when modal opens
        function showDeveloperInfo() {
            loadUpdates();
            const developerModal = document.getElementById('developerModal');
            developerModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            const contactModal = document.getElementById('contactModal');
            const developerModal = document.getElementById('developerModal');
            const donationModal = document.getElementById('donationModal');
            if (event.target === contactModal) {
                closeContactSheet();
            }
            if (event.target === developerModal) {
                closeDeveloperModal();
            }
            if (event.target === donationModal) {
                closeDonationModal();
            }
        }

        // Global functions
        window.toggleMobileMenu = toggleMobileMenu;
        window.showDeveloperInfo = showDeveloperInfo;
        window.showContactSheet = showContactSheet;
        window.closeContactSheet = closeContactSheet;
        window.closeDeveloperModal = closeDeveloperModal;
        window.showDonationBreakdown = showDonationBreakdown;
        window.closeDonationModal = closeDonationModal;
        window.togglePanel = togglePanel;
        window.copyEmail = copyEmail;
        
        // Prevent zoom on double tap
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
        
        // Full screen on load
        window.addEventListener('load', function() {
            if (window.navigator.standalone === true) {
                document.body.classList.add('standalone');
            }
        });
        
        // Error handling for mobile
        window.addEventListener('error', function(e) {
            console.error('Mobile app error:', e.error);
            // Don't show error to user, just log it
        });
        
        // Ensure all scripts are loaded before initializing
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Mobile app DOM loaded');
            
            // Check if all scripts loaded successfully
            const checkScriptsLoaded = () => {
                if (window.scriptLoadStatus.loaded >= window.scriptLoadStatus.total) {
                    console.log('All scripts loaded successfully');
                    hideLoadingIndicator();
                } else if (window.scriptLoadStatus.loaded > 0) {
                    console.log(`Partial script loading: ${window.scriptLoadStatus.loaded}/${window.scriptLoadStatus.total} loaded`);
                    console.log('Errors:', window.scriptLoadStatus.errors);
                    hideLoadingIndicator();
                } else {
                    console.log('No scripts loaded, using fallback mode');
                    hideLoadingIndicator();
                }
            };
            
            const hideLoadingIndicator = () => {
                const loadingIndicator = document.getElementById('loadingIndicator');
                if (loadingIndicator) {
                    loadingIndicator.style.opacity = '0';
                    setTimeout(() => {
                        loadingIndicator.style.display = 'none';
                    }, 300);
                }
            };
            
            // Check immediately and also after a delay
            checkScriptsLoaded();
            setTimeout(checkScriptsLoaded, 2000);
        });
        
        // Handle script loading errors gracefully
        window.addEventListener('error', function(e) {
            console.error('Script loading error:', e);
            // Hide loading indicator even if there are errors
            const loadingIndicator = document.getElementById('loadingIndicator');
            if (loadingIndicator) {
                loadingIndicator.innerHTML = '<div style="color: #ff6b6b;">App loaded with some features unavailable</div>';
                setTimeout(() => {
                    loadingIndicator.style.display = 'none';
                }, 2000);
            }
        });
        
        // Fallback for slow connections
        setTimeout(() => {
            const loadingIndicator = document.getElementById('loadingIndicator');
            if (loadingIndicator && loadingIndicator.style.display !== 'none') {
                loadingIndicator.innerHTML = '<div>Taking longer than expected... Please wait</div>';
            }
        }, 5000);
        
        // Register Service Worker for offline functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('Service Worker registered successfully:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New content is available, notify user
                                    if (confirm('New version available! Reload to update?')) {
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch(error => {
                        console.error('Service Worker registration failed:', error);
                    });
            });
        }
        
        // Handle app installation prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button or banner
            const installPrompt = document.createElement('div');
            installPrompt.innerHTML = `
                <div style="position: fixed; bottom: 20px; left: 20px; right: 20px; background: #2E7D32; color: white; padding: 1rem; border-radius: 10px; text-align: center; z-index: 1000;">
                    <p style="margin: 0 0 1rem 0;">Install Islamic Companion for a better experience!</p>
                    <button onclick="installApp()" style="background: #FFD700; color: #2E7D32; border: none; padding: 0.5rem 1rem; border-radius: 5px; font-weight: bold; margin-right: 0.5rem;">Install</button>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: transparent; color: white; border: 1px solid white; padding: 0.5rem 1rem; border-radius: 5px;">Later</button>
                </div>
            `;
            document.body.appendChild(installPrompt);
        });
        
        // Install app function
        window.installApp = function() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    }
                    deferredPrompt = null;
                });
            }
        };
    </script>
</body>
</html>
