<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Quran Reader - Fixed</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: var(--dark-green);
            color: var(--light-green);
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }
        .surah-test {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }
        .arabic-text {
            font-family: 'Amiri', serif;
            font-size: 1.5rem;
            color: var(--gold);
            text-align: right;
            direction: rtl;
            margin: 10px 0;
        }
        .transliteration {
            color: var(--light-green);
            font-style: italic;
            margin: 5px 0;
        }
        .translation {
            color: var(--text-secondary, #ccc);
            margin: 5px 0;
        }
        .error {
            color: #ff6b6b;
            background: rgba(255,107,107,0.1);
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .success {
            color: #51cf66;
            background: rgba(81,207,102,0.1);
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Quran Reader Test - Fixed Version</h1>
        <p>Testing the fixed Quran reader functionality...</p>
        
        <div id="test-results">
            <div class="success">‚úÖ Loading Quran data...</div>
        </div>
        
        <div id="surah-tests">
            <h2>Testing Surahs:</h2>
            <div id="surah-1" class="surah-test">
                <h3>Surah 1: Al-Fatihah</h3>
                <div id="surah-1-content">Loading...</div>
            </div>
            
            <div id="surah-112" class="surah-test">
                <h3>Surah 112: Al-Ikhlas</h3>
                <div id="surah-112-content">Loading...</div>
            </div>
        </div>
    </div>

    <!-- Load Quran data -->
    <script src="js/complete-quran-all-surahs.js"></script>
    <script src="js/quran-loader.js"></script>
    
    <script>
        function updateTestResults(message, type = 'success') {
            const results = document.getElementById('test-results');
            results.innerHTML = `<div class="${type}">${message}</div>`;
        }
        
        function testSurah(surahNumber) {
            const quranData = window.completeQuranAllSurahs || window.completeQuranFull;
            
            if (!quranData || !quranData[surahNumber]) {
                return `<div class="error">‚ùå Surah ${surahNumber} not found</div>`;
            }
            
            const surah = quranData[surahNumber];
            let html = `<div class="success">‚úÖ Surah ${surahNumber}: ${surah.name} (${surah.english})</div>`;
            html += `<p>Type: ${surah.type} | Verses: ${surah.verses} | Juz: ${Array.isArray(surah.juz) ? surah.juz.join(', ') : surah.juz}</p>`;
            
            if (surah.verses_data && surah.verses_data.length > 0) {
                html += '<h4>Sample Verses:</h4>';
                surah.verses_data.slice(0, 3).forEach((verse, index) => {
                    html += `
                        <div style="margin: 10px 0; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 5px;">
                            <div class="arabic-text">${verse.arabic}</div>
                            <div class="transliteration">${verse.transliteration}</div>
                            <div class="translation">${verse.translation}</div>
                        </div>
                    `;
                });
            } else {
                html += '<div class="error">‚ùå No verse data available</div>';
            }
            
            return html;
        }
        
        function runTests() {
            console.log('üß™ Running Quran Reader Tests...');
            
            // Test 1: Check if Quran data is loaded
            const quranData = window.completeQuranAllSurahs || window.completeQuranFull;
            
            if (!quranData) {
                updateTestResults('‚ùå No Quran data loaded', 'error');
                return;
            }
            
            const surahCount = Object.keys(quranData).length;
            updateTestResults(`‚úÖ Quran data loaded! Found ${surahCount} surahs`, 'success');
            
            // Test 2: Test specific surahs
            document.getElementById('surah-1-content').innerHTML = testSurah(1);
            document.getElementById('surah-112-content').innerHTML = testSurah(112);
            
            // Test 3: Check for errors
            const errors = [];
            Object.keys(quranData).forEach(surahNum => {
                const surah = quranData[surahNum];
                if (!surah.name || !surah.arabic) {
                    errors.push(`Surah ${surahNum} missing basic data`);
                }
            });
            
            if (errors.length > 0) {
                updateTestResults(`‚ö†Ô∏è Found ${errors.length} errors: ${errors.join(', ')}`, 'error');
            } else {
                updateTestResults('üéâ All tests passed! Quran reader is working correctly.', 'success');
            }
        }
        
        // Wait for data to load
        window.addEventListener('quranDataLoaded', function() {
            console.log('Quran data loaded event received');
            runTests();
        });
        
        // Fallback timeout
        setTimeout(() => {
            console.log('Fallback timeout triggered');
            runTests();
        }, 3000);
    </script>
</body>
</html>
